<html>
  <head>
    <script src="/build/graphToD3.web.js"></script>
    <style>
      #dropContainer {
        position: fixed;
        left: 50%;
        top: 50%;
        margin-top: -250px;
        margin-left: -250px;
      }
    </style>
  </head>
  <body>
    <div id="dropContainer"></div>
    <script>

    let container = document.querySelector("#dropContainer");
    let actions;
    actions = graphToD3(container, "/resources/Drops.svg", {
      xRay: false,
      width: 1000,
      height: 1000,
      margin: 200,
      nodeRadius: 100,
      bandwidth: 11,
      threshold: 0.010,
      noHover: true,
      noFixed: true,
      linkStrength: 0.8,
      borderPoints: 40,
      scale: 0.2,
      internalPoints: 0,
      distanceModifier: 300,
      maxEdgeDistance: 50
    });

    window.actions = actions;

    let x = 100, y = 100;

    let drops = {
      0: {x, y, group: 0},
      1: {x, y, group: 1},
      2: {x, y, group: 2},
      3: {x, y, group: 3},
      4: {x, y, group: 4},
      5: {x, y, group: 5},
      6: {x, y, group: 6},
      7: {x, y, group: 7}
    };

    let drop;

    document.addEventListener('node-clicked', function (e) {
      drop = drops[e.data.group];
    }, false);

    document.addEventListener("keyup", (e)=> {
      let strength = 0.8;
      let radius = 0.1;
      let stride = 300;
      let timeout = 500;
      let objectIndex = 0;

      switch(e.key) {
        case "a":
        case "d":
        case "s":
        case "w":
        objectIndex = 1;
        break;
      }

      switch(e.key) {
        case "a":
        case "ArrowLeft":
          drop.x -= stride;
          break;
        case "d":
        case "ArrowRight":
          drop.x += stride;
          break;
        case "w":
        case "ArrowUp":
          drop.y -= stride;
          break;
        case "s":
        case "ArrowDown":
          drop.y += stride;
          break;
      }
      actions.forceAtPoint(drop.x, drop.y, {strength, radius, timeout, group: drop.group});
    });

    </script>
  </body>
</html>
